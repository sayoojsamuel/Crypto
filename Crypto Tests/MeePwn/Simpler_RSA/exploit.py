from Crypto.Util.number import *

n=1235280093599323856390922798440377476467763531842392869674688408727824382702235317
g=1110549711091392805024587195974719739929628997819528005374351081843256209971586072
h=610466084395822279908554174354632326166097007218620288020807622478449585661028278
p=1057817919251064684989791981
q=1103935256393984899021164397
with open ("enc.txt") as f:
	c=f.read().strip("\n[]").split()
for i in range(len(c)):
	c[i]=int(c[i].strip("L,"))

# we have c = g^m * h^r mod n
#i.e, c = g^m * g^nr mod n
#now powering both sides with a=(p-1)(q-1) we get to eliminate r as g^nra mod n is 1 [Generates phi(n)] (Eulers Theorem)
#this reduces the equation to c^a mod n = g^ma mod n


a=(p-1) * (q-1)
#now bruteforcing for m, we get the flag

flag=""
for i in c:
	for j in range(127):
		if pow(i,a,n)==pow(g,j*a,n):
			flag+=chr(j)
print flag
